1773794118
441d63ebbc39eba359c9061ece8482bd-phpdoc%3A5de8b9f62402ea88afb20f05e46c4726-cf8276c809a2b8c03c986a339f83d59d
s:28844:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBuYW1lIjtzOjE4OiJzaW1wbGUtcGhwdW5pdC5waHAiO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAbmFtZXNwYWNlcyI7YTowOnt9czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBpbmNsdWRlcyI7YTowOnt9czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBmdW5jdGlvbnMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAY29uc3RhbnRzIjthOjA6e31zOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNsYXNzZXMiO2E6MTp7czozMjoiXFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQiO086MzU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfIjoxNTp7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGltcGxlbWVudHMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBjb25zdGFudHMiO2E6MDp7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwcm9wZXJ0aWVzIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0aG9kcyI7YTowOnt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAHVzZWRUcmFpdHMiO2E6MDp7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NDYxO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NDYzO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBmcXNlbiI7TzozMDoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuIjoyOntzOjM3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAGZxc2VuIjtzOjMyOiJcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdCI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjMxOiJTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0Ijt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGRvY0Jsb2NrIjtOO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwYXJlbnQiO047czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGFic3RyYWN0IjtiOjA7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGZpbmFsIjtiOjA7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAHJlYWRPbmx5IjtiOjA7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAG1ldGFkYXRhIjthOjA6e31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AYXR0cmlidXRlcyI7YTowOnt9fX1zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGludGVyZmFjZXMiO2E6MDp7fXM6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAdHJhaXRzIjthOjA6e31zOjQwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGVudW1zIjthOjA6e31zOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6ImNmODI3NmM4MDlhMmI4YzAzYzk4NmEzMzlmODNkNTlkIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHBhdGgiO3M6NTI6InZlbmRvci9zeW1mb255L3BocHVuaXQtYnJpZGdlL2Jpbi9zaW1wbGUtcGhwdW5pdC5waHAiO3M6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAc291cmNlIjtzOjE5MjEzOiI8P3BocAoKLyoKICogVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIFN5bWZvbnkgcGFja2FnZS4KICoKICogKGMpIEZhYmllbiBQb3RlbmNpZXIgPGZhYmllbkBzeW1mb255LmNvbT4KICoKICogRm9yIHRoZSBmdWxsIGNvcHlyaWdodCBhbmQgbGljZW5zZSBpbmZvcm1hdGlvbiwgcGxlYXNlIHZpZXcgdGhlIExJQ0VOU0UKICogZmlsZSB0aGF0IHdhcyBkaXN0cmlidXRlZCB3aXRoIHRoaXMgc291cmNlIGNvZGUuCiAqLwoKLy8gUGxlYXNlIHVwZGF0ZSB3aGVuIHBocHVuaXQgbmVlZHMgdG8gYmUgcmVpbnN0YWxsZWQgd2l0aCBmcmVzaCBkZXBzOgovLyBDYWNoZS1JZDogMjAyMS0wMi0wNCAxMTowMCBVVEMKCmlmICgnY2xpJyAhPT0gXFBIUF9TQVBJICYmICdwaHBkYmcnICE9PSBcUEhQX1NBUEkpIHsKICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RoaXMgc2NyaXB0IG11c3QgYmUgcnVuIGZyb20gdGhlIGNvbW1hbmQgbGluZS4nKTsKfQoKZXJyb3JfcmVwb3J0aW5nKC0xKTsKCmdsb2JhbCAkYXJndiwgJGFyZ2M7CiRhcmd2ID0gJF9TRVJWRVJbJ2FyZ3YnXSA/PyBbXTsKJGFyZ2MgPSAkX1NFUlZFUlsnYXJnYyddID8/IDA7CiRnZXRFbnZWYXIgPSBmdW5jdGlvbiAoJG5hbWUsICRkZWZhdWx0ID0gZmFsc2UpIHVzZSAoJGFyZ3YpIHsKICAgIGlmIChmYWxzZSAhPT0gJHZhbHVlID0gZ2V0ZW52KCRuYW1lKSkgewogICAgICAgIHJldHVybiAkdmFsdWU7CiAgICB9CgogICAgc3RhdGljICRwaHB1bml0Q29uZmlnID0gbnVsbDsKICAgIGlmIChudWxsID09PSAkcGhwdW5pdENvbmZpZykgewogICAgICAgICRwaHB1bml0Q29uZmlnRmlsZW5hbWUgPSBudWxsOwogICAgICAgICRnZXRQaHBVbml0Q29uZmlnID0gZnVuY3Rpb24gKCRwcm9iYWJsZUNvbmZpZykgdXNlICgmJGdldFBocFVuaXRDb25maWcpIHsKICAgICAgICAgICAgaWYgKCEkcHJvYmFibGVDb25maWcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpc19kaXIoJHByb2JhYmxlQ29uZmlnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuICRnZXRQaHBVbml0Q29uZmlnKCRwcm9iYWJsZUNvbmZpZy5cRElSRUNUT1JZX1NFUEFSQVRPUi4ncGhwdW5pdC54bWwnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRwcm9iYWJsZUNvbmZpZykpIHsKICAgICAgICAgICAgICAgIHJldHVybiAkcHJvYmFibGVDb25maWc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRwcm9iYWJsZUNvbmZpZy4nLmRpc3QnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuICRwcm9iYWJsZUNvbmZpZy4nLmRpc3QnOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9OwoKICAgICAgICBmb3JlYWNoICgkYXJndiBhcyAkY2xpQXJndW1lbnRJbmRleCA9PiAkY2xpQXJndW1lbnQpIHsKICAgICAgICAgICAgaWYgKCctLScgPT09ICRjbGlBcmd1bWVudCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gbG9uZyBvcHRpb24KICAgICAgICAgICAgaWYgKCctLWNvbmZpZ3VyYXRpb24nID09PSAkY2xpQXJndW1lbnQgJiYgYXJyYXlfa2V5X2V4aXN0cygkY2xpQXJndW1lbnRJbmRleCArIDEsICRhcmd2KSkgewogICAgICAgICAgICAgICAgJHBocHVuaXRDb25maWdGaWxlbmFtZSA9ICRnZXRQaHBVbml0Q29uZmlnKCRhcmd2WyRjbGlBcmd1bWVudEluZGV4ICsgMV0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gc2hvcnQgb3B0aW9uCiAgICAgICAgICAgIGlmICgwID09PSBzdHJwb3MoJGNsaUFyZ3VtZW50LCAnLWMnKSkgewogICAgICAgICAgICAgICAgaWYgKCctYycgPT09ICRjbGlBcmd1bWVudCAmJiBhcnJheV9rZXlfZXhpc3RzKCRjbGlBcmd1bWVudEluZGV4ICsgMSwgJGFyZ3YpKSB7CiAgICAgICAgICAgICAgICAgICAgJHBocHVuaXRDb25maWdGaWxlbmFtZSA9ICRnZXRQaHBVbml0Q29uZmlnKCRhcmd2WyRjbGlBcmd1bWVudEluZGV4ICsgMV0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkcGhwdW5pdENvbmZpZ0ZpbGVuYW1lID0gJGdldFBocFVuaXRDb25maWcoc3Vic3RyKCRjbGlBcmd1bWVudCwgMikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRwaHB1bml0Q29uZmlnRmlsZW5hbWUgPSAkcGhwdW5pdENvbmZpZ0ZpbGVuYW1lID86ICRnZXRQaHBVbml0Q29uZmlnKCdwaHB1bml0LnhtbCcpOwoKICAgICAgICBpZiAoJHBocHVuaXRDb25maWdGaWxlbmFtZSkgewogICAgICAgICAgICAkcGhwdW5pdENvbmZpZyA9IG5ldyBET01Eb2N1bWVudCgpOwogICAgICAgICAgICAkcGhwdW5pdENvbmZpZy0+bG9hZCgkcGhwdW5pdENvbmZpZ0ZpbGVuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkcGhwdW5pdENvbmZpZyA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgIGlmIChmYWxzZSAhPT0gJHBocHVuaXRDb25maWcpIHsKICAgICAgICAkdmFyID0gbmV3IERPTVhQYXRoKCRwaHB1bml0Q29uZmlnKTsKICAgICAgICBmb3JlYWNoICgkdmFyLT5xdWVyeSgnLy9waHAvc2VydmVyW0BuYW1lPSInLiRuYW1lLiciXScpIGFzICR2YXIpIHsKICAgICAgICAgICAgcmV0dXJuICR2YXItPmdldEF0dHJpYnV0ZSgndmFsdWUnKTsKICAgICAgICB9CiAgICAgICAgZm9yZWFjaCAoJHZhci0+cXVlcnkoJy8vcGhwL2VudltAbmFtZT0iJy4kbmFtZS4nIl0nKSBhcyAkdmFyKSB7CiAgICAgICAgICAgIHJldHVybiAkdmFyLT5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkZGVmYXVsdDsKfTsKCiRwYXNzdGhydU9yRmFpbCA9IGZ1bmN0aW9uICgkY29tbWFuZCkgewogICAgcGFzc3RocnUoJGNvbW1hbmQsICRzdGF0dXMpOwoKICAgIGlmICgkc3RhdHVzKSB7CiAgICAgICAgZXhpdCgkc3RhdHVzKTsKICAgIH0KfTsKCmlmIChcUEhQX1ZFUlNJT05fSUQgPj0gODAwMDApIHsKICAgICRQSFBVTklUX1ZFUlNJT04gPSAkZ2V0RW52VmFyKCdTWU1GT05ZX1BIUFVOSVRfVkVSU0lPTicsICc5LjYnKSA/OiAnOS42JzsKfSBlbHNlaWYgKFxQSFBfVkVSU0lPTl9JRCA+PSA3MDIwMCkgewogICAgJFBIUFVOSVRfVkVSU0lPTiA9ICRnZXRFbnZWYXIoJ1NZTUZPTllfUEhQVU5JVF9WRVJTSU9OJywgJzguNScpID86ICc4LjUnOwp9IGVsc2UgewogICAgJFBIUFVOSVRfVkVSU0lPTiA9ICRnZXRFbnZWYXIoJ1NZTUZPTllfUEhQVU5JVF9WRVJTSU9OJywgJzcuNScpID86ICc3LjUnOwp9CgokTUFYX1BIUFVOSVRfVkVSU0lPTiA9ICRnZXRFbnZWYXIoJ1NZTUZPTllfTUFYX1BIUFVOSVRfVkVSU0lPTicsIGZhbHNlKTsKCmlmICgkTUFYX1BIUFVOSVRfVkVSU0lPTiAmJiB2ZXJzaW9uX2NvbXBhcmUoJE1BWF9QSFBVTklUX1ZFUlNJT04sICRQSFBVTklUX1ZFUlNJT04sICc8JykpIHsKICAgICRQSFBVTklUX1ZFUlNJT04gPSAkTUFYX1BIUFVOSVRfVkVSU0lPTjsKfQoKJFBIUFVOSVRfUkVNT1ZFX1JFVFVSTl9UWVBFSElOVCA9IGZpbHRlcl92YXIoJGdldEVudlZhcignU1lNRk9OWV9QSFBVTklUX1JFTU9WRV9SRVRVUk5fVFlQRUhJTlQnLCAnMCcpLCBcRklMVEVSX1ZBTElEQVRFX0JPT0xFQU4pOwoKJENPTVBPU0VSX0pTT04gPSBnZXRlbnYoJ0NPTVBPU0VSJykgPzogJ2NvbXBvc2VyLmpzb24nOwoKJHJvb3QgPSBfX0RJUl9fOwp3aGlsZSAoIWZpbGVfZXhpc3RzKCRyb290LicvJy4kQ09NUE9TRVJfSlNPTikgfHwgZmlsZV9leGlzdHMoJHJvb3QuJy9EZXByZWNhdGlvbkVycm9ySGFuZGxlci5waHAnKSkgewogICAgaWYgKCRyb290ID09PSBkaXJuYW1lKCRyb290KSkgewogICAgICAgIGJyZWFrOwogICAgfQogICAgJHJvb3QgPSBkaXJuYW1lKCRyb290KTsKfQoKJG9sZFB3ZCA9IGdldGN3ZCgpOwokUEhQVU5JVF9ESVIgPSBydHJpbSgkZ2V0RW52VmFyKCdTWU1GT05ZX1BIUFVOSVRfRElSJywgJHJvb3QuJy92ZW5kb3IvYmluLy5waHB1bml0JyksICcvJy5cRElSRUNUT1JZX1NFUEFSQVRPUik7CiRQSFAgPSBkZWZpbmVkKCdQSFBfQklOQVJZJykgPyBcUEhQX0JJTkFSWSA6ICdwaHAnOwokUEhQID0gZXNjYXBlc2hlbGxhcmcoJFBIUCk7CmlmICgncGhwZGJnJyA9PT0gXFBIUF9TQVBJKSB7CiAgICAkUEhQIC49ICcgLXFycic7Cn0KCiRkZWZhdWx0RW52cyA9IFsKICAgICdDT01QT1NFUicgPT4gJ2NvbXBvc2VyLmpzb24nLAogICAgJ0NPTVBPU0VSX1ZFTkRPUl9ESVInID0+ICd2ZW5kb3InLAogICAgJ0NPTVBPU0VSX0JJTl9ESVInID0+ICdiaW4nLAogICAgJ0NPTVBPU0VSX05PX0lOVEVSQUNUSU9OJyA9PiAnMScsCiAgICAnU1lNRk9OWV9TSU1QTEVfUEhQVU5JVF9CSU5fRElSJyA9PiBfX0RJUl9fLApdOwoKZm9yZWFjaCAoJGRlZmF1bHRFbnZzIGFzICRlbnZOYW1lID0+ICRlbnZWYWx1ZSkgewogICAgaWYgKCRlbnZWYWx1ZSAhPT0gZ2V0ZW52KCRlbnZOYW1lKSkgewogICAgICAgIHB1dGVudigiJGVudk5hbWU9JGVudlZhbHVlIik7CiAgICAgICAgJF9TRVJWRVJbJGVudk5hbWVdID0gJF9FTlZbJGVudk5hbWVdID0gJGVudlZhbHVlOwogICAgfQp9CgppZiAoJ2Rpc2FibGVkJyA9PT0gJGdldEVudlZhcignU1lNRk9OWV9ERVBSRUNBVElPTlNfSEVMUEVSJykpIHsKICAgIHB1dGVudignU1lNRk9OWV9ERVBSRUNBVElPTlNfSEVMUEVSPWRpc2FibGVkJyk7Cn0KCmlmICghJGdldEVudlZhcignRE9DVFJJTkVfREVQUkVDQVRJT05TJykpIHsKICAgIHB1dGVudignRE9DVFJJTkVfREVQUkVDQVRJT05TPXRyaWdnZXInKTsKICAgICRfU0VSVkVSWydET0NUUklORV9ERVBSRUNBVElPTlMnXSA9ICRfRU5WWydET0NUUklORV9ERVBSRUNBVElPTlMnXSA9ICd0cmlnZ2VyJzsKfQoKJENPTVBPU0VSID0gKCRDT01QT1NFUiA9IGdldGVudignQ09NUE9TRVJfQklOQVJZJykpCiAgICB8fCBmaWxlX2V4aXN0cygkQ09NUE9TRVIgPSAkb2xkUHdkLicvY29tcG9zZXIucGhhcicpCiAgICB8fCAoJENPTVBPU0VSID0gcnRyaW0oKHN0cmluZykgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gcHJlZ19yZXBsYWNlKCcvW1xyXG5dLiovJywgJycsIHNoZWxsX2V4ZWMoJ3doZXJlLmV4ZSBjb21wb3Nlci5waGFyIDI+IE5VTCcpKSA6IHNoZWxsX2V4ZWMoJ3doaWNoIGNvbXBvc2VyLnBoYXIgMj4gL2Rldi9udWxsJykpKSkKICAgIHx8ICgkQ09NUE9TRVIgPSBydHJpbSgoc3RyaW5nKSAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgPyBwcmVnX3JlcGxhY2UoJy9bXHJcbl0uKi8nLCAnJywgc2hlbGxfZXhlYygnd2hlcmUuZXhlIGNvbXBvc2VyIDI+IE5VTCcpKSA6IHNoZWxsX2V4ZWMoJ3doaWNoIGNvbXBvc2VyIDI+IC9kZXYvbnVsbCcpKSkpCiAgICB8fCBmaWxlX2V4aXN0cygkQ09NUE9TRVIgPSBydHJpbSgoc3RyaW5nKSAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgPyBzaGVsbF9leGVjKCdnaXQgcmV2LXBhcnNlIC0tc2hvdy10b3BsZXZlbCAyPiBOVUwnKSA6IHNoZWxsX2V4ZWMoJ2dpdCByZXYtcGFyc2UgLS1zaG93LXRvcGxldmVsIDI+IC9kZXYvbnVsbCcpKSkuXERJUkVDVE9SWV9TRVBBUkFUT1IuJ2NvbXBvc2VyLnBoYXInKQogICAgPyAoJyMhL3Vzci9iaW4vZW52IHBocCcgPT09IGZpbGVfZ2V0X2NvbnRlbnRzKCRDT01QT1NFUiwgZmFsc2UsIG51bGwsIDAsIDE4KSA/ICRQSFAgOiAnJykuJyAnLmVzY2FwZXNoZWxsYXJnKCRDT01QT1NFUikgLy8gZGV0ZWN0IHNoZWxsIHdyYXBwZXJzIGJ5IGxvb2tpbmcgYXQgdGhlIHNoZWJhbmcKICAgIDogJ2NvbXBvc2VyJzsKCiRwcmV2Q2FjaGVEaXIgPSBnZXRlbnYoJ0NPTVBPU0VSX0NBQ0hFX0RJUicpOwppZiAoJHByZXZDYWNoZURpcikgewogICAgaWYgKGZhbHNlID09PSAkYWJzb2x1dGVDYWNoZURpciA9IHJlYWxwYXRoKCRwcmV2Q2FjaGVEaXIpKSB7CiAgICAgICAgQG1rZGlyKCRwcmV2Q2FjaGVEaXIsIDA3NzcsIHRydWUpOwogICAgICAgICRhYnNvbHV0ZUNhY2hlRGlyID0gcmVhbHBhdGgoJHByZXZDYWNoZURpcik7CiAgICB9CiAgICBpZiAoJGFic29sdXRlQ2FjaGVEaXIpIHsKICAgICAgICBwdXRlbnYoIkNPTVBPU0VSX0NBQ0hFX0RJUj0kYWJzb2x1dGVDYWNoZURpciIpOwogICAgfSBlbHNlIHsKICAgICAgICAkcHJldkNhY2hlRGlyID0gZmFsc2U7CiAgICB9Cn0KJFNZTUZPTllfUEhQVU5JVF9SRU1PVkUgPSAkZ2V0RW52VmFyKCdTWU1GT05ZX1BIUFVOSVRfUkVNT1ZFJywgJ3BocHNwZWMvcHJvcGhlY3knLigkUEhQVU5JVF9WRVJTSU9OIDwgNi4wID8gJyBzeW1mb255L3lhbWwnIDogJycpKTsKJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFID0gJGdldEVudlZhcignU1lNRk9OWV9QSFBVTklUX1JFUVVJUkUnLCAnJyk7CiRjb25maWd1cmF0aW9uSGFzaCA9IG1kNShpbXBsb2RlKFxQSFBfRU9MLCBbbWQ1X2ZpbGUoX19GSUxFX18pLCAkU1lNRk9OWV9QSFBVTklUX1JFTU9WRSwgJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFLCAoaW50KSAkUEhQVU5JVF9SRU1PVkVfUkVUVVJOX1RZUEVISU5UXSkpOwokUEhQVU5JVF9WRVJTSU9OX0RJUiA9IHNwcmludGYoJ3BocHVuaXQtJXMtJWQnLCAkUEhQVU5JVF9WRVJTSU9OLCAkUEhQVU5JVF9SRU1PVkVfUkVUVVJOX1RZUEVISU5UKTsKaWYgKCFmaWxlX2V4aXN0cygiJFBIUFVOSVRfRElSLyRQSFBVTklUX1ZFUlNJT05fRElSL3BocHVuaXQiKSB8fCAkY29uZmlndXJhdGlvbkhhc2ggIT09IEBmaWxlX2dldF9jb250ZW50cygiJFBIUFVOSVRfRElSLy4kUEhQVU5JVF9WRVJTSU9OX0RJUi5tZDUiKSkgewogICAgLy8gQnVpbGQgYSBzdGFuZGFsb25lIHBocHVuaXQgd2l0aG91dCBzeW1mb255L3lhbWwgbm9yIHByb3BoZWN5IGJ5IGRlZmF1bHQKCiAgICBAbWtkaXIoJFBIUFVOSVRfRElSLCAwNzc3LCB0cnVlKTsKICAgIGNoZGlyKCRQSFBVTklUX0RJUik7CiAgICBpZiAoZmlsZV9leGlzdHMoIiRQSFBVTklUX1ZFUlNJT05fRElSIikpIHsKICAgICAgICBwYXNzdGhydShzcHJpbnRmKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gJ3JtZGlyIC9TIC9RICVzIDI+IE5VTCcgOiAncm0gLXJmICVzJywgZXNjYXBlc2hlbGxhcmcoIiRQSFBVTklUX1ZFUlNJT05fRElSLm9sZCIpKSk7CiAgICAgICAgcmVuYW1lKCIkUEhQVU5JVF9WRVJTSU9OX0RJUiIsICIkUEhQVU5JVF9WRVJTSU9OX0RJUi5vbGQiKTsKICAgICAgICBwYXNzdGhydShzcHJpbnRmKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gJ3JtZGlyIC9TIC9RICVzJyA6ICdybSAtcmYgJXMnLCBlc2NhcGVzaGVsbGFyZygiJFBIUFVOSVRfVkVSU0lPTl9ESVIub2xkIikpKTsKICAgIH0KCiAgICAkaW5mbyA9IFtdOwogICAgZm9yZWFjaCAoZXhwbG9kZSgiXG4iLCBzaGVsbF9leGVjKCIkQ09NUE9TRVIgaW5mbyAtLW5vLWFuc2kgLWEgLW4gcGhwdW5pdC9waHB1bml0IFwiJFBIUFVOSVRfVkVSU0lPTi4qXCIiKSkgYXMgJGxpbmUpIHsKICAgICAgICAkbGluZSA9IHJ0cmltKCRsaW5lKTsKCiAgICAgICAgaWYgKCEkaW5mbyAmJiBwcmVnX21hdGNoKCcvXnZlcnNpb25zICs6IC8nLCAkbGluZSkpIHsKICAgICAgICAgICAgJGluZm9bJ3ZlcnNpb25zJ10gPSBleHBsb2RlKCcsICcsIGx0cmltKHN1YnN0cigkbGluZSwgOSksICc6ICcpKTsKICAgICAgICB9IGVsc2VpZiAoaXNzZXQoJGluZm9bJ3JlcXVpcmVzJ10pKSB7CiAgICAgICAgICAgIGlmICgnJyA9PT0gJGxpbmUpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkbGluZSA9IGV4cGxvZGUoJyAnLCAkbGluZSwgMik7CiAgICAgICAgICAgICRpbmZvWydyZXF1aXJlcyddWyRsaW5lWzBdXSA9ICRsaW5lWzFdOwogICAgICAgIH0gZWxzZWlmICgkaW5mbyAmJiAncmVxdWlyZXMnID09PSAkbGluZSkgewogICAgICAgICAgICAkaW5mb1sncmVxdWlyZXMnXSA9IFtdOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoaW5fYXJyYXkoJy0tY29sb3JzPW5ldmVyJywgJGFyZ3YsIHRydWUpIHx8IChpc3NldCgkYXJndlskaSA9IGFycmF5X3NlYXJjaCgnbmV2ZXInLCAkYXJndiwgdHJ1ZSkgLSAxXSkgJiYgJy0tY29sb3JzJyA9PT0gJGFyZ3ZbJGldKSkgewogICAgICAgICRDT01QT1NFUiAuPSAnIC0tbm8tYW5zaSc7CiAgICB9IGVsc2UgewogICAgICAgICRDT01QT1NFUiAuPSAnIC0tYW5zaSc7CiAgICB9CgogICAgJGluZm8gKz0gWwogICAgICAgICd2ZXJzaW9ucycgPT4gW10sCiAgICAgICAgJ3JlcXVpcmVzJyA9PiBbJ3BocCcgPT4gJyonXSwKICAgIF07CgogICAgJHN0YWJsZVZlcnNpb25zID0gYXJyYXlfZmlsdGVyKCRpbmZvWyd2ZXJzaW9ucyddLCBmdW5jdGlvbiAoJHYpIHsKICAgICAgICByZXR1cm4gIXByZWdfbWF0Y2goJy8tZGV2JHxeZGV2LS8nLCAkdik7CiAgICB9KTsKCiAgICBpZiAoISRzdGFibGVWZXJzaW9ucykgewogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIGNyZWF0ZS1wcm9qZWN0IC0taWdub3JlLXBsYXRmb3JtLXJlcXMgLS1uby1pbnN0YWxsIC0tcHJlZmVyLWRpc3QgLS1uby1zY3JpcHRzIC0tbm8tcGx1Z2lucyAtLW5vLXByb2dyZXNzIC1zIGRldiBwaHB1bml0L3BocHVuaXQgJFBIUFVOSVRfVkVSU0lPTl9ESVIgXCIkUEhQVU5JVF9WRVJTSU9OLipcIiIpOwogICAgfSBlbHNlIHsKICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiBjcmVhdGUtcHJvamVjdCAtLWlnbm9yZS1wbGF0Zm9ybS1yZXFzIC0tbm8taW5zdGFsbCAtLXByZWZlci1kaXN0IC0tbm8tc2NyaXB0cyAtLW5vLXBsdWdpbnMgLS1uby1wcm9ncmVzcyBwaHB1bml0L3BocHVuaXQgJFBIUFVOSVRfVkVSU0lPTl9ESVIgXCIkUEhQVU5JVF9WRVJTSU9OLipcIiIpOwogICAgfQoKICAgIEBjb3B5KCIkUEhQVU5JVF9WRVJTSU9OX0RJUi9waHB1bml0LnhzZCIsICdwaHB1bml0LnhzZCcpOwogICAgY2hkaXIoIiRQSFBVTklUX1ZFUlNJT05fRElSIik7CiAgICBpZiAoJFNZTUZPTllfUEhQVU5JVF9SRU1PVkUpIHsKICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiByZW1vdmUgLS1uby11cGRhdGUgIi4kU1lNRk9OWV9QSFBVTklUX1JFTU9WRSk7CiAgICB9CiAgICBpZiAoJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFKSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgcmVxdWlyZSAtLW5vLXVwZGF0ZSAiLiRTWU1GT05ZX1BIUFVOSVRfUkVRVUlSRSk7CiAgICB9CiAgICBpZiAoNS4xIDw9ICRQSFBVTklUX1ZFUlNJT04gJiYgJFBIUFVOSVRfVkVSU0lPTiA8IDUuNCkgewogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIHJlcXVpcmUgLS1uby11cGRhdGUgcGhwdW5pdC9waHB1bml0LW1vY2stb2JqZWN0cyBcIn4zLjEuMFwiIik7CiAgICB9CgogICAgaWYgKHByZWdfbWF0Y2goJ3tcXigoXGQrK1wuKVxkKyspW1xkXC5dKiR9JywgJGluZm9bJ3JlcXVpcmVzJ11bJ3BocCddLCAkcGhwVmVyc2lvbikgJiYgdmVyc2lvbl9jb21wYXJlKCRwaHBWZXJzaW9uWzJdLic5OScsIFxQSFBfVkVSU0lPTiwgJzwnKSkgewogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIGNvbmZpZyBwbGF0Zm9ybS5waHAgXCIkcGhwVmVyc2lvblsxXS45OVwiIik7CiAgICB9IGVsc2UgewogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIGNvbmZpZyAtLXVuc2V0IHBsYXRmb3JtLnBocCIpOwogICAgfQogICAgaWYgKGZpbGVfZXhpc3RzKCRwYXRoID0gJHJvb3QuJy92ZW5kb3Ivc3ltZm9ueS9waHB1bml0LWJyaWRnZScpKSB7CiAgICAgICAgJGhheXN0YWNrID0gIiRQSFBVTklUX0RJUi8kUEhQVU5JVF9WRVJTSU9OX0RJUiI7CiAgICAgICAgJHJvb3RMZW4gPSBzdHJsZW4oJHJvb3QpOwoKICAgICAgICAkcCA9ICgkcm9vdExlbiA8PSBzdHJsZW4oJGhheXN0YWNrKSA/IHN0cl9yZXBlYXQoJy4uLycsIHN1YnN0cl9jb3VudCgkaGF5c3RhY2ssICcvJywgJHJvb3RMZW4pKSA6ICcnKS4ndmVuZG9yL3N5bWZvbnkvcGhwdW5pdC1icmlkZ2UnOwogICAgICAgIGlmIChyZWFscGF0aCgkcCkgPT09IHJlYWxwYXRoKCRwYXRoKSkgewogICAgICAgICAgICAkcGF0aCA9ICRwOwogICAgICAgIH0KICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiByZXF1aXJlIC0tbm8tdXBkYXRlIHN5bWZvbnkvcGhwdW5pdC1icmlkZ2UgXCIqQGRldlwiIik7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgY29uZmlnIHJlcG9zaXRvcmllcy5waHB1bml0LWJyaWRnZSBwYXRoICIuZXNjYXBlc2hlbGxhcmcoc3RyX3JlcGxhY2UoJy8nLCBcRElSRUNUT1JZX1NFUEFSQVRPUiwgJHBhdGgpKSk7CiAgICAgICAgaWYgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SKSB7CiAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCdjb21wb3Nlci5qc29uJywgcHJlZ19yZXBsYWNlKCcvXiggezh9KSJwaHB1bml0LWJyaWRnZSI6IFx7JC9tJywgIiQwXG4kMSAgICAiLicib3B0aW9ucyI6IHsic3ltbGluayI6IGZhbHNlfSwnLCBmaWxlX2dldF9jb250ZW50cygnY29tcG9zZXIuanNvbicpKSk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiByZXF1aXJlIC0tbm8tdXBkYXRlIHN5bWZvbnkvcGhwdW5pdC1icmlkZ2UgXCIqXCIiKTsKICAgIH0KICAgICRwcmV2Um9vdCA9IGdldGVudignQ09NUE9TRVJfUk9PVF9WRVJTSU9OJyk7CiAgICBwdXRlbnYoIkNPTVBPU0VSX1JPT1RfVkVSU0lPTj0kUEhQVU5JVF9WRVJTSU9OLjk5Iik7CiAgICAkcSA9ICdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SICYmIFxQSFBfVkVSU0lPTl9JRCA8IDgwMDAwID8gJyInIDogJyc7CiAgICAvLyAtLW5vLXN1Z2dlc3QgaXMgbm90IGluIHRoZSBsaXN0IHRvIGtlZXAgY29tcGF0IHdpdGggY29tcG9zZXIgMS4wLCB3aGljaCBpcyBzaGlwcGVkIHdpdGggVWJ1bnR1IDE2LjA0TFRTCiAgICAkZXhpdCA9IHByb2NfY2xvc2UocHJvY19vcGVuKCIkcSRDT01QT1NFUiB1cGRhdGUgLS1uby1kZXYgLS1wcmVmZXItZGlzdCAtLW5vLXByb2dyZXNzICRxIiwgW10sICRwLCBnZXRjd2QoKSkpOwogICAgcHV0ZW52KCdDT01QT1NFUl9ST09UX1ZFUlNJT04nLihmYWxzZSAhPT0gJHByZXZSb290ID8gJz0nLiRwcmV2Um9vdCA6ICcnKSk7CiAgICBpZiAoJHByZXZDYWNoZURpcikgewogICAgICAgIHB1dGVudigiQ09NUE9TRVJfQ0FDSEVfRElSPSRwcmV2Q2FjaGVEaXIiKTsKICAgIH0KICAgIGlmICgkZXhpdCkgewogICAgICAgIGV4aXQoJGV4aXQpOwogICAgfQoKICAgIC8vIE11dGF0ZSBUZXN0Q2FzZSBjb2RlCiAgICAkYWx0ZXJlZENvZGUgPSBmaWxlX2dldF9jb250ZW50cygkYWx0ZXJlZEZpbGUgPSAnLi9zcmMvRnJhbWV3b3JrL1Rlc3RDYXNlLnBocCcpOwogICAgaWYgKCRQSFBVTklUX1JFTU9WRV9SRVRVUk5fVFlQRUhJTlQpIHsKICAgICAgICAkYWx0ZXJlZENvZGUgPSBwcmVnX3JlcGxhY2UoJy9eICAgICgoPzpwcm90ZWN0ZWR8cHVibGljKSg/OiBzdGF0aWMpPyBmdW5jdGlvbiBcdytcKFwpKTogdm9pZC9tJywgJyAgICAkMScsICRhbHRlcmVkQ29kZSk7CiAgICB9CiAgICAkYWx0ZXJlZENvZGUgPSBwcmVnX3JlcGxhY2UoJy9hYnN0cmFjdCBjbGFzcyBUZXN0Q2FzZVteXHtdK1x7LycsICckMCAnLlxQSFBfRU9MLiIgICAgdXNlIFxTeW1mb255XEJyaWRnZVxQaHBVbml0XExlZ2FjeVxQb2x5ZmlsbFRlc3RDYXNlVHJhaXQ7IiwgJGFsdGVyZWRDb2RlLCAxKTsKICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRhbHRlcmVkRmlsZSwgJGFsdGVyZWRDb2RlKTsKCiAgICAvLyBNdXRhdGUgQXNzZXJ0IGNvZGUKICAgICRhbHRlcmVkQ29kZSA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRhbHRlcmVkRmlsZSA9ICcuL3NyYy9GcmFtZXdvcmsvQXNzZXJ0LnBocCcpOwogICAgJGFsdGVyZWRDb2RlID0gcHJlZ19yZXBsYWNlKCcvYWJzdHJhY3QgY2xhc3MgQXNzZXJ0W15ce10rXHsvJywgJyQwICcuXFBIUF9FT0wuIiAgICB1c2UgXFN5bWZvbnlcQnJpZGdlXFBocFVuaXRcTGVnYWN5XFBvbHlmaWxsQXNzZXJ0VHJhaXQ7IiwgJGFsdGVyZWRDb2RlLCAxKTsKICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRhbHRlcmVkRmlsZSwgJGFsdGVyZWRDb2RlKTsKCiAgICBmaWxlX3B1dF9jb250ZW50cygncGhwdW5pdCcsIDw8PCdFT1BIUCcKPD9waHAKCmRlZmluZSgnUEhQVU5JVF9DT01QT1NFUl9JTlNUQUxMJywgX19ESVJfXy4nL3ZlbmRvci9hdXRvbG9hZC5waHAnKTsKcmVxdWlyZSBQSFBVTklUX0NPTVBPU0VSX0lOU1RBTEw7CgppZiAoIWNsYXNzX2V4aXN0cyhcU3ltZm9ueUV4Y2x1ZGVMaXN0UGhwdW5pdDo6Y2xhc3MsIGZhbHNlKSkgewogICAgY2xhc3MgU3ltZm9ueUV4Y2x1ZGVMaXN0UGhwdW5pdCB7fQp9CmlmIChtZXRob2RfZXhpc3RzKFxQSFBVbml0XFV0aWxcRXhjbHVkZUxpc3Q6OmNsYXNzLCAnYWRkRGlyZWN0b3J5JykpIHsKICAgIChuZXcgUEhQVW5pdFxVdGlsXEV4Y2x1ZGVsaXN0KCkpLT5nZXRFeGNsdWRlZERpcmVjdG9yaWVzKCk7CiAgICBQSFBVbml0XFV0aWxcRXhjbHVkZUxpc3Q6OmFkZERpcmVjdG9yeShcZGlybmFtZSgobmV3IFxSZWZsZWN0aW9uQ2xhc3MoXFN5bWZvbnlFeGNsdWRlTGlzdFBocHVuaXQ6OmNsYXNzKSktPmdldEZpbGVOYW1lKCkpKTsKICAgIGNsYXNzX2V4aXN0cyhcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdDo6Y2xhc3MsIGZhbHNlKSAmJiBQSFBVbml0XFV0aWxcRXhjbHVkZUxpc3Q6OmFkZERpcmVjdG9yeShcZGlybmFtZSgobmV3IFxSZWZsZWN0aW9uQ2xhc3MoXFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQ6OmNsYXNzKSktPmdldEZpbGVOYW1lKCkpKTsKfSBlbHNlaWYgKG1ldGhvZF9leGlzdHMoXFBIUFVuaXRcVXRpbFxCbGFja2xpc3Q6OmNsYXNzLCAnYWRkRGlyZWN0b3J5JykpIHsKICAgIChuZXcgUEhQVW5pdFxVdGlsXEJsYWNrTGlzdCgpKS0+Z2V0QmxhY2tsaXN0ZWREaXJlY3RvcmllcygpOwogICAgUEhQVW5pdFxVdGlsXEJsYWNrbGlzdDo6YWRkRGlyZWN0b3J5KFxkaXJuYW1lKChuZXcgXFJlZmxlY3Rpb25DbGFzcyhcU3ltZm9ueUV4Y2x1ZGVMaXN0UGhwdW5pdDo6Y2xhc3MpKS0+Z2V0RmlsZU5hbWUoKSkpOwogICAgY2xhc3NfZXhpc3RzKFxTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0OjpjbGFzcywgZmFsc2UpICYmIFBIUFVuaXRcVXRpbFxCbGFja2xpc3Q6OmFkZERpcmVjdG9yeShcZGlybmFtZSgobmV3IFxSZWZsZWN0aW9uQ2xhc3MoXFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQ6OmNsYXNzKSktPmdldEZpbGVOYW1lKCkpKTsKfSBlbHNlIHsKICAgIFBIUFVuaXRcVXRpbFxCbGFja2xpc3Q6OiRibGFja2xpc3RlZENsYXNzTmFtZXNbJ1N5bWZvbnlFeGNsdWRlTGlzdFBocHVuaXQnXSA9IDE7CiAgICBQSFBVbml0XFV0aWxcQmxhY2tsaXN0OjokYmxhY2tsaXN0ZWRDbGFzc05hbWVzWydTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0J10gPSAxOwp9CgpTeW1mb255XEJyaWRnZVxQaHBVbml0XFRleHRVSVxDb21tYW5kOjptYWluKCk7CgpFT1BIUAogICAgKTsKICAgIGNoZGlyKCcuLicpOwogICAgZmlsZV9wdXRfY29udGVudHMoIi4kUEhQVU5JVF9WRVJTSU9OX0RJUi5tZDUiLCAkY29uZmlndXJhdGlvbkhhc2gpOwogICAgY2hkaXIoJG9sZFB3ZCk7Cn0KCi8vIENyZWF0ZSBhIHN5bWxpbmsgd2l0aCBhIHByZWRpY3RhYmxlIHBhdGggcG9pbnRpbmcgdG8gdGhlIGN1cnJlbnRseSB1c2VkIHZlcnNpb24uCi8vIFRoaXMgaXMgdXNlZnVsIGZvciBzdGF0aWMgYW5hbHl0aWNzIHRvb2xzIHN1Y2ggYXMgUEhQU3RhbiBoYXZpbmcgdG8gbG9hZCBQSFBVbml0J3MgY2xhc3NlcwovLyBhbmQgZm9yIG90aGVyIHRlc3RpbmcgbGlicmFyaWVzIHN1Y2ggYXMgQmVoYXQgdXNpbmcgUEhQVW5pdCdzIGFzc2VydGlvbnMuCmNoZGlyKCRQSFBVTklUX0RJUik7CmlmICgnXFwnID09PSBcRElSRUNUT1JZX1NFUEFSQVRPUikgewogICAgcGFzc3RocnUoJ3JtZGlyIC9TIC9RIHBocHVuaXQgMj4gTlVMJyk7CiAgICBwYXNzdGhydShzcHJpbnRmKCdta2xpbmsgL2ogcGhwdW5pdCAlcyA+IE5VTCAyPiYxJywgZXNjYXBlc2hlbGxhcmcoJFBIUFVOSVRfVkVSU0lPTl9ESVIpKSk7Cn0gZWxzZSB7CiAgICBpZiAoZmlsZV9leGlzdHMoJ3BocHVuaXQnKSkgewogICAgICAgIEB1bmxpbmsoJ3BocHVuaXQnKTsKICAgIH0KICAgIEBzeW1saW5rKCRQSFBVTklUX1ZFUlNJT05fRElSLCAncGhwdW5pdCcpOwp9CmNoZGlyKCRvbGRQd2QpOwoKaWYgKCRQSFBVTklUX1ZFUlNJT04gPCA4LjApIHsKICAgICRhcmd2ID0gYXJyYXlfZmlsdGVyKCRhcmd2LCBmdW5jdGlvbiAoJHYpIHVzZSAoJiRhcmdjKSB7CiAgICAgICAgaWYgKCctLWRvLW5vdC1jYWNoZS1yZXN1bHQnICE9PSAkdikgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLS0kYXJnYzsKCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7Cn0gZWxzZWlmIChmaWx0ZXJfdmFyKGdldGVudignU1lNRk9OWV9QSFBVTklUX0RJU0FCTEVfUkVTVUxUX0NBQ0hFJyksIFxGSUxURVJfVkFMSURBVEVfQk9PTEVBTikpIHsKICAgICRhcmd2W10gPSAnLS1kby1ub3QtY2FjaGUtcmVzdWx0JzsKICAgICsrJGFyZ2M7Cn0KCiRjb21wb25lbnRzID0gW107CiRjbWQgPSBhcnJheV9tYXAoJ2VzY2FwZXNoZWxsYXJnJywgJGFyZ3YpOwokZXhpdCA9IDA7CgppZiAoaXNzZXQoJGFyZ3ZbMV0pICYmICdzeW1mb255JyA9PT0gJGFyZ3ZbMV0gJiYgIWZpbGVfZXhpc3RzKCdzeW1mb255JykgJiYgZmlsZV9leGlzdHMoJ3NyYy9TeW1mb255JykpIHsKICAgICRhcmd2WzFdID0gJ3NyYy9TeW1mb255JzsKfQppZiAoaXNzZXQoJGFyZ3ZbMV0pICYmIGlzX2RpcigkYXJndlsxXSkgJiYgIWZpbGVfZXhpc3RzKCRhcmd2WzFdLicvcGhwdW5pdC54bWwuZGlzdCcpKSB7CiAgICAvLyBGaW5kIFN5bWZvbnkgY29tcG9uZW50cyBpbiBwbGFpbiBwaHAgZm9yIFdpbmRvd3MgcG9ydGFiaWxpdHkKCiAgICAkZmluZGVyID0gbmV3IFJlY3Vyc2l2ZURpcmVjdG9yeUl0ZXJhdG9yKCRhcmd2WzFdLCBGaWxlc3lzdGVtSXRlcmF0b3I6OktFWV9BU19GSUxFTkFNRSB8IEZpbGVzeXN0ZW1JdGVyYXRvcjo6VU5JWF9QQVRIUyk7CiAgICAkZmluZGVyID0gbmV3IFJlY3Vyc2l2ZUl0ZXJhdG9ySXRlcmF0b3IoJGZpbmRlcik7CiAgICAkZmluZGVyLT5zZXRNYXhEZXB0aChnZXRlbnYoJ1NZTUZPTllfUEhQVU5JVF9NQVhfREVQVEgnKSA/OiAzKTsKCiAgICBmb3JlYWNoICgkZmluZGVyIGFzICRmaWxlID0+ICRmaWxlSW5mbykgewogICAgICAgIGlmICgncGhwdW5pdC54bWwuZGlzdCcgPT09ICRmaWxlKSB7CiAgICAgICAgICAgICRjb21wb25lbnRzW10gPSBkaXJuYW1lKCRmaWxlSW5mby0+Z2V0UGF0aG5hbWUoKSk7CiAgICAgICAgfQogICAgfQogICAgaWYgKCRjb21wb25lbnRzKSB7CiAgICAgICAgYXJyYXlfc2hpZnQoJGNtZCk7CiAgICB9Cn0KCiRjbWRbMF0gPSBzcHJpbnRmKCclcyAlcyAtLWNvbG9ycz0lcycsICRQSFAsIGVzY2FwZXNoZWxsYXJnKCIkUEhQVU5JVF9ESVIvJFBIUFVOSVRfVkVSU0lPTl9ESVIvcGhwdW5pdCIpLCAnJyA9PT0gJGdldEVudlZhcignTk9fQ09MT1InLCAnJykgPyAnYWx3YXlzJyA6ICduZXZlcicpOwokY21kID0gc3RyX3JlcGxhY2UoJyUnLCAnJSUnLCBpbXBsb2RlKCcgJywgJGNtZCkpLicgJTEkcyc7CgppZiAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IpIHsKICAgICRjbWQgPSAnY21kIC92Om9uIC9kIC9jICIoJy4kY21kLicpJTIkcyInOwp9IGVsc2UgewogICAgJGNtZCAuPSAnJTIkcyc7Cn0KCmlmICgkY29tcG9uZW50cykgewogICAgJHNraXBwZWRUZXN0cyA9ICRfU0VSVkVSWydTWU1GT05ZX1BIUFVOSVRfU0tJUFBFRF9URVNUUyddID8/IGZhbHNlOwogICAgJHJ1bm5pbmdQcm9jcyA9IFtdOwoKICAgIGZvcmVhY2ggKCRjb21wb25lbnRzIGFzICRjb21wb25lbnQpIHsKICAgICAgICAvLyBSdW4gcGhwdW5pdCB0ZXN0cyBpbiBwYXJhbGxlbAoKICAgICAgICBpZiAoJHNraXBwZWRUZXN0cykgewogICAgICAgICAgICBwdXRlbnYoIlNZTUZPTllfUEhQVU5JVF9TS0lQUEVEX1RFU1RTPSRjb21wb25lbnQvJHNraXBwZWRUZXN0cyIpOwogICAgICAgIH0KCiAgICAgICAgJGMgPSBlc2NhcGVzaGVsbGFyZygkY29tcG9uZW50KTsKCiAgICAgICAgaWYgKCRwcm9jID0gcHJvY19vcGVuKHNwcmludGYoJGNtZCwgJGMsICIgPiAkYy9waHB1bml0LnN0ZG91dCAyPiAkYy9waHB1bml0LnN0ZGVyciIpLCBbXSwgJHBpcGVzKSkgewogICAgICAgICAgICAkcnVubmluZ1Byb2NzWyRjb21wb25lbnRdID0gJHByb2M7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJGV4aXQgPSAxOwogICAgICAgICAgICBlY2hvICJcMDMzWzQxbUtPXDAzM1swbSAkY29tcG9uZW50XG5cbiI7CiAgICAgICAgfQogICAgfQoKICAgICRsYXN0T3V0cHV0ID0gbnVsbDsKICAgICRsYXN0T3V0cHV0VGltZSA9IG51bGw7CgogICAgd2hpbGUgKCRydW5uaW5nUHJvY3MpIHsKICAgICAgICB1c2xlZXAoMzAwMDAwKTsKICAgICAgICAkdGVybWluYXRlZFByb2NzID0gW107CiAgICAgICAgZm9yZWFjaCAoJHJ1bm5pbmdQcm9jcyBhcyAkY29tcG9uZW50ID0+ICRwcm9jKSB7CiAgICAgICAgICAgICRwcm9jU3RhdHVzID0gcHJvY19nZXRfc3RhdHVzKCRwcm9jKTsKICAgICAgICAgICAgaWYgKCEkcHJvY1N0YXR1c1sncnVubmluZyddKSB7CiAgICAgICAgICAgICAgICAkdGVybWluYXRlZFByb2NzWyRjb21wb25lbnRdID0gJHByb2NTdGF0dXNbJ2V4aXRjb2RlJ107CiAgICAgICAgICAgICAgICB1bnNldCgkcnVubmluZ1Byb2NzWyRjb21wb25lbnRdKTsKICAgICAgICAgICAgICAgIHByb2NfY2xvc2UoJHByb2MpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoISR0ZXJtaW5hdGVkUHJvY3MgJiYgMSA9PT0gY291bnQoJHJ1bm5pbmdQcm9jcykpIHsKICAgICAgICAgICAgJGNvbXBvbmVudCA9IGtleSgkcnVubmluZ1Byb2NzKTsKCiAgICAgICAgICAgICRvdXRwdXQgPSBmaWxlX2dldF9jb250ZW50cygiJGNvbXBvbmVudC9waHB1bml0LnN0ZG91dCIpOwogICAgICAgICAgICAkb3V0cHV0IC49IGZpbGVfZ2V0X2NvbnRlbnRzKCIkY29tcG9uZW50L3BocHVuaXQuc3RkZXJyIik7CgogICAgICAgICAgICBpZiAoJGxhc3RPdXRwdXQgIT09ICRvdXRwdXQpIHsKICAgICAgICAgICAgICAgICRsYXN0T3V0cHV0ID0gJG91dHB1dDsKICAgICAgICAgICAgICAgICRsYXN0T3V0cHV0VGltZSA9IG1pY3JvdGltZSh0cnVlKTsKICAgICAgICAgICAgfSBlbHNlaWYgKG1pY3JvdGltZSh0cnVlKSAtICRsYXN0T3V0cHV0VGltZSA+IDYwKSB7CiAgICAgICAgICAgICAgICBlY2hvICJcMDMzWzQxbVRpbWVvdXRcMDMzWzBtICRjb21wb25lbnRcblxuIjsKCiAgICAgICAgICAgICAgICBpZiAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IpIHsKICAgICAgICAgICAgICAgICAgICBleGVjKHNwcmludGYoJ3Rhc2traWxsIC9GIC9UIC9QSUQgJWQgMj4mMScsICRwcm9jU3RhdHVzWydwaWQnXSksICRvdXRwdXQsICRleGl0Q29kZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHByb2NfdGVybWluYXRlKGN1cnJlbnQoJHJ1bm5pbmdQcm9jcykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3JlYWNoICgkdGVybWluYXRlZFByb2NzIGFzICRjb21wb25lbnQgPT4gJHByb2NTdGF0dXMpIHsKICAgICAgICAgICAgZm9yZWFjaCAoWydvdXQnLCAnZXJyJ10gYXMgJGZpbGUpIHsKICAgICAgICAgICAgICAgICRmaWxlID0gIiRjb21wb25lbnQvcGhwdW5pdC5zdGQkZmlsZSI7CiAgICAgICAgICAgICAgICByZWFkZmlsZSgkZmlsZSk7CiAgICAgICAgICAgICAgICB1bmxpbmsoJGZpbGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBGYWlsIG9uIGFueSBpbmRpdmlkdWFsIGNvbXBvbmVudCBmYWlsdXJlcyBidXQgaWdub3JlIHNvbWUgZXJyb3IgY29kZXMgb24gV2luZG93cyB3aGVuIEFQQ3UgaXMgZW5hYmxlZDoKICAgICAgICAgICAgLy8gU1RBVFVTX1NUQUNLX0JVRkZFUl9PVkVSUlVOICgtMTA3Mzc0MDc5MS8weEMwMDAwNDA5KQogICAgICAgICAgICAvLyBTVEFUVVNfQUNDRVNTX1ZJT0xBVElPTiAoLTEwNzM3NDE4MTkvMHhDMDAwMDAwNSkKICAgICAgICAgICAgLy8gU1RBVFVTX0hFQVBfQ09SUlVQVElPTiAoLTEwNzM3NDA5NDAvMHhDMDAwMDM3NCkKICAgICAgICAgICAgaWYgKCRwcm9jU3RhdHVzICYmICgnXFwnICE9PSBcRElSRUNUT1JZX1NFUEFSQVRPUiB8fCAhZXh0ZW5zaW9uX2xvYWRlZCgnYXBjdScpIHx8ICFmaWx0ZXJfdmFyKGluaV9nZXQoJ2FwYy5lbmFibGVfY2xpJyksIFxGSUxURVJfVkFMSURBVEVfQk9PTEVBTikgfHwgIWluX2FycmF5KCRwcm9jU3RhdHVzLCBbLTEwNzM3NDA3OTEsIC0xMDczNzQxODE5LCAtMTA3Mzc0MDk0MF0pKSkgewogICAgICAgICAgICAgICAgJGV4aXQgPSAkcHJvY1N0YXR1czsKICAgICAgICAgICAgICAgIGVjaG8gIlwwMzNbNDFtS09cMDMzWzBtICRjb21wb25lbnRcblxuIjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVjaG8gIlwwMzNbMzJtT0tcMDMzWzBtICRjb21wb25lbnRcblxuIjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfSBlbHNlaWYgKCFpc3NldCgkYXJndlsxXSkgfHwgJ2luc3RhbGwnICE9PSAkYXJndlsxXSB8fCBmaWxlX2V4aXN0cygnaW5zdGFsbCcpKSB7CiAgICBpZiAoIWNsYXNzX2V4aXN0cyhcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdDo6Y2xhc3MsIGZhbHNlKSkgewogICAgICAgIGNsYXNzIFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQKICAgICAgICB7CiAgICAgICAgfQogICAgfQogICAgYXJyYXlfc3BsaWNlKCRhcmd2LCAxLCAwLCBbJy0tY29sb3JzPScuKCcnID09PSAkZ2V0RW52VmFyKCdOT19DT0xPUicsICcnKSA/ICdhbHdheXMnIDogJ25ldmVyJyldKTsKICAgICRfU0VSVkVSWydhcmd2J10gPSAkYXJndjsKICAgICRfU0VSVkVSWydhcmdjJ10gPSArKyRhcmdjOwogICAgaW5jbHVkZSAiJFBIUFVOSVRfRElSLyRQSFBVTklUX1ZFUlNJT05fRElSL3BocHVuaXQiOwp9CgpleGl0KCRleGl0KTsKIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGRvY0Jsb2NrIjtOO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAbWV0YWRhdGEiO2E6MDp7fX0=";